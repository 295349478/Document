{"EpubVersion":2,"filepath":"","floatingtheme":[],"folded":false,"markups":[{"content":"应该设置一个标记位\n来标记用户是否正常使用\n而框架对这个有做处理，直接使用即可\n\n创建对应的认证信息有两种：\n1、传入账号密码、角色信息直接创建\n2、第二种就是左边的这种，","date":"2022-03-28 20:42:29","docid":0,"fillcolor":"ffffed99","folded":false,"id":1,"markups":[{"date":"2022-03-28 20:43:21","docid":0,"fillcolor":"ffffed99","folded":true,"id":2,"markups":[{"date":"2022-03-28 21:01:08","docid":0,"fillcolor":"ffffed99","id":4,"originaltext":"boolean enabled  是否可用","page":0,"textblocks":[{"first":[74.86637878417969,457.9359436035156,5.979194641113281,12.5],"last":[185.61782836914062,457.9359436035156,9.75396728515625,12.5],"length":21,"rects":[[74.86637878417969,457.9359436035156,120.50541687011719,12.5]],"start":152,"text":"boolean enabled  是否可用"}],"type":5},{"date":"2022-03-28 21:01:13","docid":0,"fillcolor":"ffffed99","id":5,"originaltext":"boolean accountNonExpired 账户是否失效","page":0,"textblocks":[{"first":[74.86613464355469,471.336669921875,5.979179382324219,14.50286865234375],"last":[255.28114318847656,471.336669921875,9.753952026367188,14.50286865234375],"length":32,"rects":[[74.86613464355469,471.336669921875,190.16896057128906,14.50286865234375]],"start":174,"text":"boolean accountNonExpired 账户是否失效"}],"type":5},{"date":"2022-03-28 21:01:18","docid":0,"fillcolor":"ffffed99","id":6,"originaltext":"boolean credentialsNonExpired 秘密是否失效","page":0,"textblocks":[{"first":[74.8660659790039,486.35308837890625,5.9791717529296875,14.493927001953125],"last":[269.0531005859375,486.35308837890625,9.75390625,14.493927001953125],"length":36,"rects":[[74.8660659790039,486.35308837890625,203.9409408569336,14.493927001953125]],"start":207,"text":"boolean credentialsNonExpired 秘密是否失效"}],"type":5},{"date":"2022-03-28 21:01:23","docid":0,"fillcolor":"ffffed99","id":7,"originaltext":"boolean accountNonLocked 账户是否锁定","page":0,"textblocks":[{"first":[74.86569213867188,504.4542236328125,5.9791412353515625,9.5],"last":[253.03610229492188,504.4542236328125,9.753875732421875,9.5],"length":31,"rects":[[74.86569213867188,504.4542236328125,187.92428588867188,9.5]],"start":244,"text":"boolean accountNonLocked 账户是否锁定"}],"type":5}],"originaltext":"1 源码分析","page":0,"textblocks":[{"first":[66.96864318847656,125.80072021484375,9.746673583984375,19.5],"last":[132.35374450683594,125.80072021484375,17.069427490234375,19.5],"length":6,"rects":[[66.96864318847656,125.80072021484375,82.45452880859375,19.5]],"start":12,"text":"1 源码分析"}],"type":5},{"content":"直接配置用户状态，如果状态不对，会抛出异常","date":"2022-03-28 20:43:46","docid":0,"fillcolor":"ffffed99","id":3,"originaltext":"2 判断认证用户的状态","page":0,"textblocks":[{"first":[66.96793365478516,526.575439453125,9.746574401855469,20.5],"last":[217.69895935058594,526.575439453125,17.06927490234375,20.5],"length":11,"rects":[[66.96793365478516,526.575439453125,167.80030059814453,20.5]],"start":278,"text":"2 判断认证用户的状态"}],"type":5}],"originaltext":"一、设置用户状态","page":0,"textblocks":[{"first":[52.357730865478516,82.88668060302734,21.946712493896484,25.5],"last":[205.9847412109375,82.88668060302734,21.94671630859375,25.5],"length":8,"rects":[[52.357730865478516,82.88668060302734,175.57372665405273,25.5]],"start":0,"text":"一、设置用户状态"}],"type":5},{"content":"退出的功能也需要两个要求\n1、一定需要使用post请求\n2、跨域会有token 的验证\n\n其他的在配置过程的时候已经配置了\n注销的请求地址和成功后跳转的页面","date":"2022-03-29 11:15:41","docid":0,"fillcolor":"ffffed99","id":8,"originaltext":"二、退出登录","page":1,"textblocks":[{"first":[52.35717010498047,194.66482543945312,21.94647979736328,25.5],"last":[162.0895538330078,194.66482543945312,21.94647216796875,25.5],"length":6,"rects":[[52.35717010498047,194.66482543945312,131.6788558959961,25.5]],"start":24,"text":"二、退出登录"}],"type":5},{"content":"在认证的时候顺便做的","date":"2022-03-29 11:18:26","docid":0,"fillcolor":"ffffed99","folded":false,"id":9,"markups":[{"date":"2022-03-29 11:20:30","docid":0,"fillcolor":"ffffed99","folded":false,"id":10,"markups":[{"content":"1、在\nAbstractAuthenticationProcessingFilter（这个过滤器做的就是登录成功后的步骤）\n使用security的容器SecurityContext存储认证信息\n2、调用RememberMeServices的方法来处理记住功能\n\n","date":"2022-03-29 11:20:36","docid":0,"fillcolor":"ffffed99","id":11,"originaltext":"AbstractRememberMeServices","page":1,"textblocks":[{"first":[130.38856506347656,471.3161315917969,6.17425537109375,14.5],"last":[265.03131103515625,471.3161315917969,4.65264892578125,14.5],"length":26,"rects":[[130.38856506347656,471.3161315917969,139.29539489746094,14.5]],"start":158,"text":"AbstractRememberMeServices"}],"type":5},{"content":"进入到这个服务\n1、将请求和“remember-me”字符串传递\n2、调用的方法从请求中获取“remember-me”字符串的值，判断是什么，可以是true，on，yes，1，返回true","date":"2022-03-29 11:34:45","docid":0,"fillcolor":"ffffed99","id":12,"originaltext":"rememberMeRequested","page":1,"textblocks":[{"first":[155.66995239257812,715.1741943359375,3.9796295166015625,14.5],"last":[260.7609558105469,715.1741943359375,5.97918701171875,14.5],"length":19,"rects":[[155.66995239257812,715.1741943359375,111.0701904296875,14.5]],"start":217,"text":"rememberMeRequested"}],"type":5},{"content":"生成一份对应的token放到数据库中，还有cookie中\n以便下次直接对应token","date":"2022-03-29 11:35:24","docid":0,"fillcolor":"ffffed99","id":13,"originaltext":"onLoginSuccess","page":2,"textblocks":[{"first":[371.448486328125,371.90582275390625,5.89141845703125,8.5],"last":[438.83880615234375,371.90582275390625,4.65264892578125,8.5],"length":14,"rects":[[371.448486328125,371.90582275390625,72.04296875,8.5]],"start":79,"text":"onLoginSuccess"}],"type":5}],"originaltext":"1 记住我功能原理分析","page":1,"textblocks":[{"first":[66.96842956542969,411.394287109375,9.74664306640625,20.5],"last":[217.70068359375,411.394287109375,17.069412231445312,20.5],"length":11,"rects":[[66.96842956542969,411.394287109375,167.80166625976562,20.5]],"start":111,"text":"1 记住我功能原理分析"}],"type":5},{"date":"2022-03-29 11:37:42","docid":0,"fillcolor":"ffffed99","id":14,"originaltext":"2 记住我功能页面代码","page":2,"textblocks":[{"first":[66.96864318847656,705.5549926757812,9.746673583984375,20.5],"last":[217.70091247558594,705.5549926757812,17.069427490234375,20.5],"length":11,"rects":[[66.96864318847656,705.5549926757812,167.80169677734375,20.5]],"start":101,"text":"2 记住我功能页面代码"}],"type":5},{"date":"2022-03-29 11:38:43","docid":0,"fillcolor":"ffffed99","id":16,"originaltext":"3 开启remember me过滤器","page":3,"textblocks":[{"first":[66.96864318847656,541.721435546875,9.746673583984375,13.5],"last":[270.4427795410156,541.721435546875,17.069427490234375,13.5],"length":18,"rects":[[66.96864318847656,541.721435546875,220.54356384277344,13.5]],"start":109,"text":"3 开启remember me过滤器"}],"type":5},{"date":"2022-03-29 11:50:54","docid":0,"fillcolor":"ffffed99","folded":false,"id":17,"markups":[{"date":"2022-03-29 11:51:29","docid":0,"fillcolor":"ffffed99","id":19,"originaltext":"SpringSecurity还提供了remember me的另一种相对更安全的实现机制 ","page":4,"textblocks":[{"first":[81.619140625,108.18448638916016,5.354942321777344,14.5],"last":[387.95074462890625,108.18448638916016,2.536041259765625,14.5],"length":44,"rects":[[81.619140625,108.18448638916016,308.8676452636719,14.5]],"start":147,"text":"SpringSecurity还提供了remember me的另一种相对更安全的实现机制 "}],"type":5}],"originaltext":"4 remember me安全性分析","page":3,"textblocks":[{"first":[66.96864318847656,724.6472778320312,9.746673583984375,20.5],"last":[270.44281005859375,724.6472778320312,17.069427490234375,20.5],"length":18,"rects":[[66.96864318847656,724.6472778320312,220.54359436035156,20.5]],"start":217,"text":"4 remember me安全性分析"}],"type":5},{"content":"对于持久化token表都是固定了\n并且需要配置指定表","date":"2022-03-29 11:50:59","docid":0,"fillcolor":"ffffed99","id":18,"originaltext":"5 持久化remember me信息","page":4,"textblocks":[{"first":[66.96864318847656,168.32568359375,9.746673583984375,12.5],"last":[270.4427795410156,168.32568359375,17.069427490234375,12.5],"length":18,"rects":[[66.96864318847656,168.32568359375,220.54356384277344,12.5]],"start":302,"text":"5 持久化remember me信息"}],"type":5}],"originaltext":"三、remember me","page":1,"textblocks":[{"first":[52.35717010498047,376.1358642578125,21.94647979736328,15.5],"last":[238.90335083007812,376.1358642578125,12.970321655273438,15.5],"length":13,"rects":[[52.35717010498047,376.1358642578125,199.5165023803711,15.5]],"start":94,"text":"三、remember me"}],"type":5},{"content":"后端可以使用\nSecurityContextHolder.getContext().getAuthentication().getName()\n获取用户名\n从security中获取上下文找到认证成功账号的名字\n\n也可以直接拿认证的对象实体（已经填入数据）\nSecurityContextHolder.getContext().getAuthentication().getPrincipal()\n来获取信息","date":"2022-03-29 14:10:45","docid":0,"fillcolor":"ffffed99","id":20,"originaltext":"四、显示当前认证用户名","page":4,"textblocks":[{"first":[52.35792541503906,623.5035400390625,21.94671630859375,24.5],"last":[271.8251037597656,623.5035400390625,21.94671630859375,24.5],"length":11,"rects":[[52.35792541503906,623.5035400390625,241.4138946533203,24.5]],"start":403,"text":"四、显示当前认证用户名"}],"type":5},{"date":"2022-03-29 14:14:53","docid":0,"fillcolor":"ffffed99","id":21,"originaltext":"五、授权准备工作","page":5,"textblocks":[{"first":[52.35717010498047,178.57122802734375,21.94647979736328,24.5],"last":[205.9824981689453,178.57122802734375,21.94647216796875,24.5],"length":8,"rects":[[52.35717010498047,178.57122802734375,175.5718002319336,24.5]],"start":2,"text":"五、授权准备工作"}],"type":5},{"content":"使用\n<security:authorize access=\"hasAnyRole('ROLE_ADMIN','ROLE_PRODUCT')\">\n</security:authorize>\n来决定是否显示菜单","date":"2022-03-29 14:18:45","docid":0,"fillcolor":"ffffed99","id":22,"originaltext":"六、动态展示菜单","page":5,"textblocks":[{"first":[52.35717010498047,719.5447998046875,21.94647979736328,24.5],"last":[205.9824981689453,719.5447998046875,21.94647216796875,24.5],"length":8,"rects":[[52.35717010498047,719.5447998046875,175.5718002319336,24.5]],"start":59,"text":"六、动态展示菜单"}],"type":5},{"content":"因为SpringSecurity是需要安全的被保护起来才行，所以一定要把他放在父容器中\n\n1、注解可以放在controller也可以放在service上，从业务上讲应该放到service上保证安全\n\n注意：对于security的引用到了父容器中，但是使用却是在子容器的controller上会失效\n所以对于开启了服务，到底是哪里开启，还有用在哪里需要配套\n\n（会被缓存影响）","date":"2022-03-29 14:46:15","docid":0,"fillcolor":"ffffed99","folded":false,"id":23,"markups":[{"date":"2022-03-29 14:48:05","docid":0,"fillcolor":"ffffed99","id":24,"originaltext":"1 开启授权的注解支持","page":8,"textblocks":[{"first":[66.96842956542969,441.4498291015625,9.74664306640625,20.5],"last":[217.70068359375,441.4498291015625,17.069412231445312,20.5],"length":11,"rects":[[66.96842956542969,441.4498291015625,167.80166625976562,20.5]],"start":302,"text":"1 开启授权的注解支持"}],"type":5},{"content":"一般是加在业务层上的","date":"2022-03-29 15:23:58","docid":0,"fillcolor":"ffffed99","id":25,"originaltext":"2 在注解支持对应类或者方法上添加注解","page":9,"textblocks":[{"first":[66.96864318847656,398.9015197753906,9.746673583984375,19.5],"last":[354.2563171386719,398.9015197753906,17.069427490234375,19.5],"length":19,"rects":[[66.96864318847656,398.9015197753906,304.3571014404297,19.5]],"start":2,"text":"2 在注解支持对应类或者方法上添加注解"}],"type":5}],"originaltext":"七、授权操作","page":8,"textblocks":[{"first":[52.35717010498047,329.628662109375,21.94647979736328,24.5],"last":[162.0895538330078,329.628662109375,21.94647216796875,24.5],"length":6,"rects":[[52.35717010498047,329.628662109375,131.6788558959961,24.5]],"start":80,"text":"七、授权操作"}],"type":5},{"date":"2022-03-29 15:24:30","docid":0,"fillcolor":"ffffed99","folded":false,"id":26,"markups":[{"date":"2022-03-29 15:42:02","docid":0,"fillcolor":"ffffed99","id":27,"originaltext":"方式一：在spring-security.xml配置文件中处理","page":10,"textblocks":[{"first":[52.3225212097168,431.8930358886719,17.057926177978516,22.52996826171875],"last":[403.1167907714844,431.8930358886719,17.057861328125,22.52996826171875],"length":31,"rects":[[52.3225212097168,431.8930358886719,367.8521308898926,22.52996826171875]],"start":56,"text":"方式一：在spring-security.xml配置文件中处理"}],"type":5},{"date":"2022-03-29 15:42:08","docid":0,"fillcolor":"ffffed99","id":28,"originaltext":"方式二：在web.xml中处理","page":10,"textblocks":[{"first":[52.35717010498047,580.4947509765625,17.069480895996094,20.5078125],"last":[244.04632568359375,580.4947509765625,17.069427490234375,20.5078125],"length":15,"rects":[[52.35717010498047,580.4947509765625,208.75858306884766,20.5078125]],"start":91,"text":"方式二：在web.xml中处理"}],"type":5},{"date":"2022-03-29 15:42:12","docid":0,"fillcolor":"ffffed99","id":29,"originaltext":"方式三：编写异常处理器","page":10,"textblocks":[{"first":[52.35717010498047,700.5504150390625,17.069480895996094,20.5],"last":[223.0520477294922,700.5504150390625,17.069488525390625,20.5],"length":11,"rects":[[52.35717010498047,700.5504150390625,187.76436614990234,20.5]],"start":110,"text":"方式三：编写异常处理器"}],"type":5}],"originaltext":"八、权限不足异常处理","page":10,"textblocks":[{"first":[52.35717010498047,169.72674560546875,21.94647979736328,24.5],"last":[249.8754425048828,169.72674560546875,21.946487426757812,24.5],"length":10,"rects":[[52.35717010498047,169.72674560546875,219.46475982666016,24.5]],"start":0,"text":"八、权限不足异常处理"}],"type":5}],"maxid":29,"notelinks":[],"title":"SpringSecurity_day02","unimportant":[]}